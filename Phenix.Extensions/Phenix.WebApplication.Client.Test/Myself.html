<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>MyselfController Client Test</title>

    <script type="text/javascript" src="../Phenix.WebApplication.Client.Ajax/CryptoJS/core-min.js"></script>
    <script type="text/javascript" src="../Phenix.WebApplication.Client.Ajax/CryptoJS/enc-base64-min.js"></script>
    <script type="text/javascript" src="../Phenix.WebApplication.Client.Ajax/CryptoJS/cipher-core-min.js"></script>
    <script type="text/javascript" src="../Phenix.WebApplication.Client.Ajax/CryptoJS/aes-min.js"></script>
    <script type="text/javascript" src="../Phenix.WebApplication.Client.Ajax/CryptoJS/md5-min.js"></script>
    <script type="text/javascript" src="../Phenix.WebApplication.Client.Ajax/base64-binary.js"></script>
    <script type="text/javascript" src="../Phenix.WebApplication.Client.Ajax/json2.js"></script>
    <script type="text/javascript" src="../Phenix.WebApplication.Client.Ajax/jquery.min.js"></script>
    <script type="text/javascript" src="../Phenix.WebApplication.Client.Ajax/jquery.signalR.min.js"></script>
    <script type="text/javascript" src="../Phenix.WebApplication.Client.Ajax/jquery.cookie.js"></script>
    <script type="text/javascript" src="../Phenix.WebApplication.Client.Ajax/phenix.js"></script>

    <script type="text/javascript">

        function onComplete(XMLHttpRequest, textStatus) {
            if (XMLHttpRequest.status === 200)
                alert("成功! status: " + XMLHttpRequest.statusText + ", response: " + XMLHttpRequest.responseText);
            else if (XMLHttpRequest.status === 401)
                alert("无效! status: " + XMLHttpRequest.statusText + ", response: " + XMLHttpRequest.responseText);
            else
                alert("失败! status: " + XMLHttpRequest.statusText + ", response: " + XMLHttpRequest.responseText);
        };

        function getMyself() {
            phAjax.getMyself(
                function (result) {
                    alert(JSON.stringify(result));
                },
                function (XMLHttpRequest, textStatus, errorThrown) {
                    alert("获取自己资料失败! status: " + XMLHttpRequest.statusText + ", response: " + XMLHttpRequest.responseText);
                }
            );
        };

        function changePassword(newPassword) {
            phAjax.changePassword(newPassword,
                function(result) {
                    alert("成功修改口令");
                },
                function (XMLHttpRequest, textStatus, errorThrown) {
                    alert("修改口令失败! status: " + XMLHttpRequest.statusText + ", response: " + XMLHttpRequest.responseText);
                }
            );
        };

        $(function () {
        });

/**/</script>
</head>
<body>
    请启动 Phenix.WebApplication_MySQL/ORA 程序<br />
    <br />
    普通用户登录<br />
    新(/已注册)的登录名<input id="userName" type="text" value="TEST" />
    <input name="userCheckIn" onclick="phAjax.checkIn({baseAddress: 'http://localhost:5000', name: userName.value, onComplete: onComplete});" type="button" value="登记/注册" /><br />
    动态口令/登录口令<input id="userPassword" type="text" value="请在此输入日志文件里的口令" />
    <input name="userLogon" onclick="phAjax.logon({name: userName.value, password: userPassword.value, onComplete: onComplete});" type="button" value="登录" /><br />
    <br />
    <input name="getMyself" onclick="getMyself();" type="button" value="获取自己资料" /><br />
    <br />
    新登录口令<input id="newPassword" type="text" value="" />
    <input name="changePassword" onclick="changePassword(newPassword.value);" type="button" value="修改登录口令" /><br />
    <br />
</body>
</html>
